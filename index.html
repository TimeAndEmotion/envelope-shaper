<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Work Envelope</title>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <script>if (typeof module === 'object') { window.module = module; module = undefined; }</script>

  <!-- normal script imports etc  -->
  <script src="scripts/jquery.js"></script>

  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <link rel="stylesheet" href="css/jquery-ui.min.css">
  <script src="./libraries/jquery.dd.min.js"></script>
  <script src="https://cdn.datatables.net/1.10.13/js/jquery.dataTables.min.js"></script>

  <script language="javascript" src="libraries/quicksettings.js"></script>

  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.13/css/jquery.dataTables.min.css" />
  <link rel="stylesheet" type="text/css" href="css/msdropdown/dd.css" />
  <!-- Insert this line after script imports -->
  <script>if (window.module) module = window.module;</script>

  <style>
    li.active {
      color: red;
    }
    #drag-file {
      background-color: blue;
      color:white;
      text-align: center;
      width:800px;
      height:50px;
    }
  </style>

</head>


<body>


  <div id="container" class="container">

    <h1>Work Envelope Shaper</h1>

    <button id="btn_info" class="btn btn-info">info</button>
    <div id="info">

      <P></P>

      <h4>A very little bit of theory</h4>
      <P></P>
      This will sound irrational but we are not as rational as we think we are. We make decisions based on intuitive or self-centred
      motives informed by the environments we are in and group norms. We subconsciously camouflage.
      <P></P>
      Philosophers have tried making sense of the discrepancies between self will and collective will from Kant onwards. Now neuroscience
      has stepped in to the arena and making similar findings. (See Kahnemann - Thinking Fast, Thinking Slow for an introduction
      to psycho-economics.)
      <P></P>
      Multiple ways of considering value is Poly Value. This is a good thing. aligning viewpoints is the (he)art of sustainable
      competitive advantage.
      <P></P>
      Because we are not rational we look to provide value for ourselves as well as meeting the needs of people that pay us to
      make things other people buy.
      <P></P>
      We need to consider: Customer, Strategic, Operations, Team and Self perspectives of value.


      <h4>What benefits can I expect from Polyvalue?</h4>
      <P></P>
      <ul>
        <li>Visualising the unseen work to be done reduces cognitive lead time.</li>
        <li>Build connections, resilience and autonomy to accommodate emergent requirements and behaviour.</li>
        <li>Identify and remove blocks using A3 thinking or new found connections.</li>
        <li>Balance and blend collective needs against self will - remove political heat from conversations.</li>
        <li>Prioritise by Weighted Shortest - or Most Valuable Job First</li>
        <li>Checklists to test incoming requirements</i>
          <li>More accurate and transparent estimation focussed on value.</li>
          <li>Visualise value from other peoples and personal perspectives</li>
          <li>Apply the correct strategy</li>
      </ul>
      <P></P>
      <P></P>
      <h4>How do I do it?</h4>
      <P></P>
      Start small with Work Envelopes based on the Scan, Design, Deliver, Value cycle form the Design Thinking Toolkit.
      <div class="row">
        <!--<div class="col col-sm-6 col-lg-2">
            <img src="./images/sddv.png" />
          </div>-->
        <div class="col col-sm-6 col-lg-2">
          <img src="./images/sddv_adsr.png" />
        </div>
      </div>
      <P></P>

      <div class="col col-sm-6 col-lg-3">
        <P>
          1 Scan:
          <ol type='i'>
            <li>Assess environments</li>
            <li>Make changes to blend in</li>
            <li>Change attitude</li>
          </ol>
        </P>
      </div>

      <div class="col col-sm-6 col-lg-3">
        <P>
          2 Design Thinking:
          <ol type='i'>
            <li>Creative Analysis First</li>
            <li>Rational Analysis</li>
            <li>Reflect and Plan</li>
          </ol>
        </P>
      </div>

      <div class="col col-sm-6 col-lg-3">
        <P>
          3 Deliver:
          <ol type='i'>
            <li>Connect, Commit</li>
            <li>Resilience, Test, Deliver</li>
            <li>Autonomy, Product</li>
          </ol>
        </P>
      </div>

      <div class="col col-sm-6 col-lg-3">
        <P>
          4 Value:
          <ol type='i'>
            <li>Time to absorb</li>
            <li>Impact</li>
            <li>Reflection</li>
          </ol>
        </P>
      </div>

      <br> If you need a refresher
      <a href="http://comscientia.com/blocs/sketches/cognitive-table/index.html" target="_new">read this.</a>
      <h4>Try it out below</h4>
      Use the presets to set work profiles. Fine tune to your needs.
      <P></P>
      Scan and Design move horizontally over time. They are the cognitive lead time: work that needs to be done prior to committing
      to delivery.
      <P></P>
      The duration of the Scan and Design and amount of effort provides a guide if the work can be done in a sprint if you are
      working in an agile fashion.
      <P></P>
      Effort slides vertically. Each percentage is a proportion of the time taken on delivery. (e.g. 1 day is 10% of a two week
      sprint)
      <p></p>
      Some jobs are experience based: quick and easy. Others are relatively difficult.
      <P></P>
      Value is your personal gain. It is marked on a relative scale for the work in the period.
    </div>
    <P></P>

    <!-- Start of app -->
    <div id="drag-file">
      <p>Drag your files here</p>
    </div>


    <div id="table-controls" name="table-controls" class="row">
      <button id="btnTableSave" class="btn btn-primary">Save</button>
    </div>
    <div class="row">


      <table id="tblBacklog" class="table">
        <thead>
          <th>Id</th>
          <th>Description</th>
          <th>Profile</th>
          <th>Complexity</th>
          <th>Duration</th>
          <th>Priority</th>
          <th>Story Points</th>
        </thead>
        <tbody>

        </tbody>
      </table>
    </div>
  </div>
</div>

</div>

<script>
  let toggleInfo = false;
  $(document).ready(function () {
    $("#shapeTable").dataTable();
    $(".payments").msDropdown({ visibleRows: 13 });
    $("#info").hide();
  });

  $("#tabs").tabs();

  $(".payments").on('change', function (e) {
    console.log(this.value);
    $(".test").text(this.value);
    //console.log(this.value);
  });

  $("#the-file-input").change(function () {
    // will log a FileList object, view gifs below
    console.log(this.files);
  });

  // render the image in our view
  function renderImage(file) {

    // generate a new FileReader object
    var reader = new FileReader();

    // inject an image with the src url
    reader.onload = function (event) {
      the_url = event.target.result
      $('#some_container_div').html("<img src='" + the_url + "' />")
    }

    // when the file is read it triggers the onload event above.
    reader.readAsDataURL(file);
  }

  // handle input changes
  $("#the-file-input").change(function () {
    console.log(this.files)

    // grab the first image in the FileList object and pass it to the function
    renderImage(this.files[0])
  });

  $("#btn_info").click(function () {
    // console.log("i am toggle");
    toggleInfo = !toggleInfo;
    if (toggleInfo) {
      $("#info").show();
    } else {
      $("#info").hide();
    }
  });

  $(function () {

  });


</script>


<script>
// Interoperation scripts
  const electron = require('electron');
  const {ipcRenderer} = electron;
  const ul = document.querySelector('#backlogItems');
  const pbiName = document.querySelector('#pbiName');

  ipcRenderer.on('item:add', function(e, item) {

    let id = item[0];
    let desc = item[1];
    let priority = item[2];
    let storyPoints = item[3];
    let complexity = 0;//%item[4];

    data = [ id,
              desc,
              getDD(id),
              '<input name="cmplxty_' + id + '" value = ' + complexity + '></input>',
              '<input name="duration_' + id + '" value = 0></input>',
              priority,
              storyPoints];

    console.log(data);
    table = $("#tblBacklog").DataTable().row.add(data).rows().draw();

    $(".payments").msDropdown({visibleRows:13})

    });
</script>
</body>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
crossorigin="anonymous"></script>


<script>
   let table;

   function getDD(id) {


   // Using JQuery for nostalgic reasons!
   let dd = `
            <select name = sel_` + id +` class="payments" style="width:300px;">
                <option selected value="0" data-image="./images/blank.png" data-description=""></option>
                <option value="1" data-image="./images/mallet.png" data-description="">Fast, no value</option>
                <option value="2" data-image="./images/bass.png">Medium Design & effort. No value</option>
                <option value="3" data-image="./images/keyboards.png" data-description="">Long, no value</option>
                <option value="4" data-image="./images/guitar.png" data-description="">Chore</option>

                <option value="5" data-image="./images/drum.png" data-description="">Non Functional Requirement</option>
                <option value="6" data-image="./images/strings.png" data-description="">Design and Value #1</option>
                <option value="7" data-image="./images/horns.png" data-description="">Design and Value #2</option>
                <option value="8" data-image="./images/woodwind.png" data-description="">Design and Value #3</option>

                <option value="9" data-image="./images/synth-basic.png" data-description="">Generic</option>
                <option value="10" data-image="./images/synth-lead.png" data-description="">Spike</option>
                <option value="11" data-image="./images/synth-pad.png" data-description="">High Effort & Value</option>
                <option value="12" data-image="./images/synth-texture.png" data-description="">At the Max</option>

            </select>
        `;
      return dd;
  }
	$(document).ready(function() {
    // $(document).ready(function (){
   var table = $('#tblBacklog').DataTable({
      "pageLength": 50,
      'columnDefs': [
         {
            // 'targets': [1, 2, 3],
            'render': function(data, type, row, meta){
               if(type === 'display'){
                  var api = new $.fn.dataTable.Api(meta.settings);

                  var $el = $('input, select, textarea', api.cell({ row: meta.row, column: meta.col }).node());

                  var $html = $(data).wrap('<div/>').parent();

                  if($el.prop('tagName') === 'INPUT'){
                     $('input', $html).attr('value', $el.val());
                     if($el.prop('checked')){
                        $('input', $html).attr('checked', 'checked');
                     }
                  } else if ($el.prop('tagName') === 'TEXTAREA'){
                     $('textarea', $html).html($el.val());

                  } else if ($el.prop('tagName') === 'SELECT'){
                     $('option:selected', $html).removeAttr('selected');
                     $('option', $html).filter(function(){
                        return ($(this).attr('value') === $el.val());
                     }).attr('selected', 'selected');
                  }

                  data = $html.html();
               }

               return data;
            }
         }
      ],

      'responsive': true
      });

      $('#tblBacklog tbody').on('change','td', function(e) {
        var data = $('#tblBacklog').DataTable().$('input, select').serialize();
        console.log("Data from change : ", data)
      });

     $("#btnTableSave").on('click', function(e) {
        var data = $('#tblBacklog').DataTable().$('input, select').serialize();
        console.log("Data: ", data)
     });
        return false;
    } );

    // class to provide drop down shapes
    $(".payments").msDropdown({visibleRows:13});

 $("#tabs").tabs();

 $(".payments").on('change', function(e) {
	 console.log(this.value);
	 $(".test").text(this.value);
	 //console.log(this.value);
	});

	$("#the-file-input").change(function() {
		 // will log a FileList object, view gifs below
		 console.log(this.files);
 });

 // render the image in our view
function renderImage(file) {

 // generate a new FileReader object
 var reader = new FileReader();

 // inject an image with the src url
 reader.onload = function(event) {
	 the_url = event.target.result
	 $('#some_container_div').html("<img src='" + the_url + "' />")
 }

 // when the file is read it triggers the onload event above.
 reader.readAsDataURL(file);
}

// handle input changes
$("#the-file-input").change(function() {
	 console.log(this.files)

	 // grab the first image in the FileList object and pass it to the function
	 renderImage(this.files[0])
});

$("#btnInfo").click(function() {
 toggleInfo = !toggleInfo;
 if (toggleInfo) {
	 $("#info").show();
 } else {
	 $("#info").hide();
 }
});

$( function() {

 } );
</script>

<script>
  // Drag and drop functions
  (function () {
      var holder = document.getElementById('drag-file');

      holder.ondragover = () => {
          return false;
      };
      holder.ondragleave = () => {
          return false;
      };

      holder.ondragend = () => {
          return false;
      };

      holder.ondrop = (e) => {
          e.preventDefault();

          for (let f of e.dataTransfer.files) {
              console.log('File(s) you dragged here: ', f.path)
              ipcRenderer.send("openFile", f.path.toString())
              // ipcRenderer.send('item:add', item)
          }

          return false;
      };
  })();
</script>
</html>